name: Google Chat Notification

on:
  issues:
    types: [opened, edited, reopened]

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Send Notification via curl
        env:
          # GitHubのSettings > Secrets > Actions に登録したURL
          WEBHOOK_URL: ${{ secrets.GOOGLE_CHAT_WEBHOOK }}
        run: |
          # メッセージ本文を構築
          # ※ヒアドキュメント(EOF)を使うことで、改行や変数を安全に扱えます
          JSON_DATA=$(cat <<EOF
          {
            "text": "📋 *Issueが更新されました*\n\n**アクション:** ${{ github.event.action }}\n**タイトル:** ${{ github.event.issue.title }}\n**実行者:** ${{ github.actor }}\n**URL:** ${{ github.event.issue.html_url }}"
          }
          EOF
          )

          # Google Chatへ送信
          curl -X POST -H 'Content-Type: application/json' \
          -d "$JSON_DATA" \
          "$WEBHOOK_URL"
